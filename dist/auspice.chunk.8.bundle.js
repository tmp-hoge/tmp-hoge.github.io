(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{530:function(t,e,s){var a=s(531);"string"==typeof a&&(a=[[t.i,a,""]]);s(45)(a,{});a.locals&&(t.exports=a.locals)},531:function(t,e,s){(t.exports=s(44)(!1)).push([t.i,'\n/* Variables - keep in sync with globalStyles.js*/\n:root {\n  --darkGrey: #333;\n  --medGrey: #888;\n}\n\n#d3entropy .overlay {\n  fill: none;\n  pointer-events: all;\n}\n\n#d3entropy .brush {\n  stroke: none;\n}\n\n#d3entropy .niceText {\n  font-family: "Lato", "Helvetica Neue", "Helvetica", "sans-serif";\n  font-size: 14px;\n  font-style: italic;\n  color: var(--medGrey);\n}\n\n.brush .selection {\n  cursor: grab;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n}\n',""])},712:function(t,e,s){"use strict";s.r(e);var a=s(55),n=s.n(a),o=s(56),i=s.n(o),r=s(57),l=s.n(r),c=s(58),h=s.n(c),d=s(59),p=s.n(d),u=s(35),f=s.n(u),y=s(3),v=s.n(y),m=s(15),x=s.n(m),g=s(43),b=s(499),M=(s(503),s(505)),w=s(522),N=s(500),C=s(29),k=s(532),O=s(54),B=s(705),z=s(706),_=s(521),j=s.n(_),G=s(24),E=s(123),S=s(2),T=function(t,e,s,a,n){this.svg=Object(b.f)(t),this.annotations=e,this.geneMap=s,this.maxNt=a,this.callbacks=n,this.okToDrawBars=!1};T.prototype.render=function(t){this.props=t,this.aa="aa"===t.mutType,this.bars=t.bars,this.selectedNodes=Object(G.isColorByGenotype)(t.colorBy)?this._getSelectedNodes(Object(G.decodeColorByGenotype)(t.colorBy,t.geneLength)):[],this.svg.selectAll("*").remove(),this._calcOffsets(t.width,t.height),this._drawMainNavElements(),this._addZoomLayers(),this._setScales(this.maxNt+1,t.maxYVal),this.zoomCoordinates=Object(G.isColorByGenotype)(t.colorBy)?this._getZoomCoordinates(Object(G.decodeColorByGenotype)(t.colorBy,t.geneLength),t.geneMap):this.scales.xNav.domain(),this.zoomCoordinates[0]=t.zoomMin?t.zoomMin:this.zoomCoordinates[0],this.zoomCoordinates[1]=t.zoomMax?t.zoomMax:this.zoomCoordinates[1],this._drawAxes(),this._addBrush(),this._addClipMask(),this._drawGenes(this.annotations),this._drawZoomGenes(this.annotations),this.okToDrawBars=!0,this._drawBars(),this.zoomed=this._createZoomFn()},T.prototype.update=function(t){var e=this,s=t.aa,a=void 0===s?void 0:s,n=t.selected,o=void 0===n?void 0:n,i=t.newBars,r=void 0===i?void 0:i,l=t.maxYVal,c=void 0===l?void 0:l,h=t.clearSelected,d=void 0!==h&&h,p=t.gene,u=void 0===p?void 0:p,f=t.start,y=void 0===f?void 0:f,v=t.end,m=void 0===v?void 0:v,x=t.zoomMax,g=void 0===x?void 0:x,b=t.zoomMin,M=void 0===b?void 0:b,w=void 0!==a&&a!==this.aa;if((r||w)&&(w&&(this.aa=a),r&&(this.bars=r),this._updateYScaleAndAxis(c),this._drawBars()),void 0!==o?(this._clearSelectedBars(),this.selectedNodes=this._getSelectedNodes(o),this._highlightSelectedBars()):d&&this._clearSelectedBars(),void 0!==u&&void 0!==y&&void 0!==m){var N=m-y,C=u===S.nucleotide_gene?0:1*N;this.navGraph.select(".brush").call(this.brush.move,(function(){return[Math.max(e.scales.xNav(y-C),e.scales.xNav(0)),Math.min(e.scales.xNav(m+C),e.scales.xNav(e.scales.xNav.domain()[1]))]}))}if(void 0!==M||void 0!==g){var k=void 0===M?0:M,O=void 0===g?this.scales.xNav.domain()[1]:g;this.navGraph.select(".brush").call(this.brush.move,(function(){return[e.scales.xNav(k),e.scales.xNav(O)]}))}},T.prototype._aaToNtCoord=function(t,e){return"-"===this.geneMap[t].strand?this.geneMap[t].end-3*e+1:this.geneMap[t].start+3*e-2},T.prototype._getZoomCoordinates=function(t,e){var s=[0,this.scales.xNav.domain()[1]],a=0;if(t.aa){var n=t.gene;a=1*((s=[e[n].start,e[n].end])[1]-s[0])}else{var o=this.scales.xNav.domain()[1];if(1===t.positions.length){var i=t.positions[0],r=.05*o;s=i-r<=0?[0,i+r]:i+r>=o?[i-r,o]:[i-r,i+r]}else{var l=Math.min.apply(null,t.positions),c=Math.max.apply(null,t.positions);s=[l-.05*(c-l),c+.05*(c-l)]}}return[Math.max(s[0]-a,0),Math.min(s[1]+a,this.scales.xNav.domain()[1])]},T.prototype._getSelectedNodes=function(t){if(this.aa===t.aa){var e=[];if(this.aa){var s=[],a=!0,n=!1,o=void 0;try{for(var i,r=t.positions[Symbol.iterator]();!(a=(i=r.next()).done);a=!0){var l=i.value;s.push([t.gene,l])}}catch(t){n=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(n)throw o}}var c=!0,h=!1,d=void 0;try{for(var p,u=this.bars[Symbol.iterator]();!(c=(p=u.next()).done);c=!0)for(var f=p.value,y=0,v=s;y<v.length;y++){var m=v[y];f.prot===m[0]&&f.codon===m[1]&&e.push(f)}}catch(t){h=!0,d=t}finally{try{c||null==u.return||u.return()}finally{if(h)throw d}}}else{var x=!0,g=!1,b=void 0;try{for(var M,w=this.bars[Symbol.iterator]();!(x=(M=w.next()).done);x=!0){var N=M.value;-1!==t.positions.indexOf(N.x)&&e.push(N)}}catch(t){g=!0,b=t}finally{try{x||null==w.return||w.return()}finally{if(g)throw b}}}return e}console.error("entropy out of sync")},T.prototype._drawZoomGenes=function(t){var e=this;this.geneGraph.selectAll("*").remove();var s=this.scales.xNav.domain()[1]-this.scales.xNav.domain()[0]<1e6?"white":"black",a=!!t.filter((function(t){return"-"===t.strand})).length,n=function(t){return a?"-"===t?20:0:10},o=t.filter((function(t){return t.start<e.scales.xMain.domain()[1]&&t.start>e.scales.xMain.domain()[0]||t.end>e.scales.xMain.domain()[0]&&t.end<e.scales.xMain.domain()[1]||t.start<=e.scales.xMain.domain()[0]&&t.end>=e.scales.xMain.domain()[1]})),i=function(t){return t.start>e.scales.xMain.domain()[0]?e.scales.xMain(t.start):e.offsets.x1},r=function(t){return t.end<e.scales.xMain.domain()[1]?e.scales.xMain(t.end):e.offsets.x2},l=this.geneGraph.selectAll(".gene").data(o).enter().append("g");l.append("rect").attr("class","gene").attr("x",(function(t){return i(t)})).attr("y",(function(t){return n(t.strand)})).attr("width",(function(t){return r(t)-i(t)})).attr("height",20).style("fill",(function(t){return t.fill})).style("stroke",(function(){return s})),l.append("text").attr("x",(function(t){return e.scales.xMain(t.start)+(e.scales.xMain(t.end)-e.scales.xMain(t.start))/2})).attr("y",(function(t){return n(t.strand)+5})).attr("dy",".7em").attr("text-anchor","middle").style("fill",(function(){return"white"})).text((function(t){return r(t)-i(t)>15?t.prot:""}))},T.prototype._drawGenes=function(t){var e=this,s=this.scales.xNav.domain()[1]-this.scales.xNav.domain()[0]<1e6?"white":"black",a=this.navGraph.selectAll(".gene").data(t).enter().append("g");a.append("rect").attr("class","gene").attr("x",(function(t){return e.scales.xNav(t.start)})).attr("y",(function(t){return t.strand,5})).attr("width",(function(t){return e.scales.xNav(t.end)-e.scales.xNav(t.start)})).attr("height",20).style("fill",(function(t){return t.fill})).style("stroke",(function(){return s})),a.append("text").attr("x",(function(t){return e.scales.xNav(t.start)+(e.scales.xNav(t.end)-e.scales.xNav(t.start))/2})).attr("y",(function(t){return t.strand,10})).attr("dy",".7em").attr("text-anchor","middle").style("fill",(function(){return"white"})).text((function(t){return function(t){return t.end<e.scales.xNav.domain()[1]?e.scales.xNav(t.end):e.offsets.x2}(t)-function(t){return t.start>e.scales.xNav.domain()[0]?e.scales.xNav(t.start):e.offsets.x1}(t)>10?t.prot:""}))},T.prototype._clearSelectedBars=function(){var t=this,e=!0,s=!1,a=void 0;try{for(var n,o=this.selectedNodes[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){var i=n.value,r=this.aa?"#prot".concat(i.prot).concat(i.codon):"#nt".concat(i.x),l=this.aa?function(e){return t.geneMap[e.prot].idx%2?N.h:N.a}:function(e){return e.prot?t.geneMap[e.prot].idx%2?N.h:N.a:N.f};Object(b.f)(r).style("fill",l)}}catch(t){s=!0,a=t}finally{try{e||null==o.return||o.return()}finally{if(s)throw a}}this.selectedNodes=[]},T.prototype._highlightSelectedBars=function(){var t=!0,e=!1,s=void 0;try{for(var a,n=this.selectedNodes[Symbol.iterator]();!(t=(a=n.next()).done);t=!0){var o=a.value;if(this.aa&&!o.prot)return;var i=this.aa?"#prot".concat(o.prot).concat(o.codon):"#nt".concat(o.x),r=this.aa?this.geneMap[o.prot].fill:o.prot?this.geneMap[o.prot].fill:"red";Object(b.f)(i).style("fill",r)}}catch(t){e=!0,s=t}finally{try{t||null==n.return||n.return()}finally{if(e)throw s}}},T.prototype._drawBars=function(){var t=this;if(this.okToDrawBars){this.mainGraph.selectAll("*").remove();var e,s=this.scales.xMain.domain()[1]-this.scales.xMain.domain()[0];this.aa&&(s/=3),e=this.aa?s>600?2:function(e){return t.scales.xMain(t._aaToNtCoord(e.prot,e.codon)+2.6)-t.scales.xMain(t._aaToNtCoord(e.prot,e.codon))}:s>1e3?2:s>250?3:function(e){return t.scales.xMain(e.x+.3)-t.scales.xMain(e.x-.3)};var a=this.mainGraph.append("g").attr("clip-path","url(#clip)").selectAll(".bar"),n=this.aa?function(t){return"prot"+t.prot+t.codon}:function(t){return"nt"+t.x},o=this.aa?function(e){return t.scales.xMain(t._aaToNtCoord(e.prot,e.codon)-.3)}:function(e){return t.scales.xMain(e.x-.3)},i=this.aa?function(e){return t.geneMap[e.prot].idx%2?N.h:N.a}:function(e){return e.prot?t.geneMap[e.prot].idx%2?N.h:N.a:N.f};a.data(this.bars).enter().append("rect").attr("class","bar").attr("id",n).attr("x",o).attr("y",(function(e){return t.scales.y(e.y)})).attr("width",e).attr("height",(function(e){return t.offsets.heightMain-t.scales.y(e.y)})).style("fill",i).on("mouseover",(function(e){t.callbacks.onHover(e,b.b.pageX,b.b.pageY)})).on("mouseout",(function(e){t.callbacks.onLeave(e)})).on("click",(function(e){t.callbacks.onClick(e)})).style("cursor","pointer"),this._highlightSelectedBars()}},T.prototype._setScales=function(t,e){this.scales={},this.scales.xMax=t,this.scales.yMax=e,this.scales.yMin=0,this.scales.xMin=0,this.scales.xMain=Object(C.a)().domain([0,t]).range([this.offsets.x1,this.offsets.x2]),this.scales.xNav=Object(C.a)().domain([0,t]).range([this.offsets.x1,this.offsets.x2]),this.scales.y=Object(C.a)().domain([this.scales.yMin,1.2*e]).range([this.offsets.y2Main,this.offsets.y1Main])},T.prototype._drawAxes=function(){this.axes={},this.axes.y=Object(k.b)(this.scales.y).ticks(4),this.axes.xMain=Object(k.a)(this.scales.xMain).ticks(16),this.axes.xNav=Object(k.a)(this.scales.xNav).ticks(20,",f"),this.scales.xNav.domain()[1]-this.scales.xNav.domain()[0]>1e6&&this.axes.xNav.tickFormat(Object(O.a)(".1e")),this.svg.append("g").attr("class","y axis").attr("id","entropyYAxis").attr("transform","translate("+(this.offsets.x1+15)+","+this.offsets.y1Main+")").call(this.axes.y),this.svg.append("g").attr("class","xMain axis").attr("transform","translate("+this.offsets.x1+","+this.offsets.y2Main+")").call(this.axes.xMain),this.svg.append("g").attr("class","xNav axis").attr("transform","translate("+this.offsets.x1+","+this.offsets.y2Nav+")").call(this.axes.xNav)},T.prototype._updateYScaleAndAxis=function(t){this.scales.y=Object(C.a)().domain([this.scales.yMin,1.2*t]).range([this.offsets.y2Main,this.offsets.y1Main]),this.axes.y=Object(k.b)(this.scales.y).ticks(4),this.svg.select("#entropyYAxis").remove(),this.svg.append("g").attr("class","y axis").attr("id","entropyYAxis").attr("transform","translate("+(this.offsets.x1+15)+","+this.offsets.y1Main+")").call(this.axes.y)},T.prototype._calcOffsets=function(t,e){this.offsets={x1:15,x2:t-32,y1Main:0,y1Nav:e-65,y2Main:e-130,y2Nav:e-35,y1Gene:e-107,y2Gene:e-95},this.offsets.heightMain=this.offsets.y2Main-this.offsets.y1Main,this.offsets.heightNav=this.offsets.y2Nav-this.offsets.y1Nav,this.offsets.heightGene=this.offsets.y2Gene-this.offsets.y1Gene,this.offsets.width=this.offsets.x2-this.offsets.x1},T.prototype._addBrush=function(){var t=this;this.brushed=function(){var t=this,e=(b.b.selection||this.scales.xNav.range()).map(this.scales.xNav.invert,this.scales.xNav);this.zoomCoordinates=e.map(Math.round),b.b.selection?this._zoom(e[0],e[1]):this.navGraph.select(".brush").call(this.brush.move,(function(){return t.zoomCoordinates=t.scales.xNav.range().map(Math.round),t.scales.xNav.range()}))},this.brushFinished=function(){this.brushed(),b.b.sourceEvent instanceof MouseEvent&&(!b.b.selection||"d3entropyParent"===b.b.sourceEvent.target.id||""===b.b.sourceEvent.target.id)?this.props.dispatch(Object(E.b)(this.zoomCoordinates)):this.props.dispatch(Object(E.b)([void 0,void 0]))},this._zoom=function(t,e){var s=this,a=[t,e];this.scales.xMain.domain(a),this.axes.xMain=this.axes.xMain.scale(this.scales.xMain),this.svg.select(".xMain.axis").call(this.axes.xMain),this._drawBars(),this._drawZoomGenes(this.annotations),this.brushHandle&&this.brushHandle.attr("display",null).attr("transform",(function(t,e){return"translate("+s.scales.xNav(a[e])+","+(s.offsets.heightNav+25)+")"}))},this.brush=Object(z.a)().extent([[this.offsets.x1,0],[this.offsets.width+20,this.offsets.heightNav-1+25]]).on("brush",(function(){t.brushed()})).on("end",(function(){t.brushFinished()})),this.gBrush=this.navGraph.append("g").attr("class","brush").attr("stroke-width",0).call(this.brush).call(this.brush.move,(function(){return t.zoomCoordinates.map(t.scales.xNav)})),this.brushHandle=this.gBrush.selectAll(".handle--custom").data([{type:"w"},{type:"e"}]).enter().append("path").attr("class","handle--custom").attr("fill",N.a).attr("cursor","ew-resize").attr("d","M0,0 0,0 -5,11 5,11 0,0 Z").attr("transform",(function(e){return"e"===e.type?"translate("+(t.scales.xNav(t.zoomCoordinates[1])-1)+","+(t.offsets.heightNav+25)+")":"translate("+(t.scales.xNav(t.zoomCoordinates[0])+1)+","+(t.offsets.heightNav+25)+")"}))},T.prototype._addZoomLayers=function(){var t=this,e=[[this.offsets.x1,this.offsets.y1Main],[this.offsets.width,this.offsets.y2Main]];this.zoom=Object(B.a)().translateExtent(e).extent(e).on("zoom",(function(){return t.zoomed()}));var s=["option","shift"];j.a.bind(s,(function(){t.svg.append("rect").attr("class","overlay").attr("text","zoom").attr("transform","translate("+t.offsets.x1+","+t.offsets.y1Main+")").attr("width",t.offsets.width).attr("height",t.offsets.y2Nav+30-t.offsets.y1Main).call(t.zoom).on("wheel",(function(){b.b.preventDefault()}))}),"keydown"),j.a.bind(s,(function(){t.svg.selectAll(".overlay").remove(),t.svg.selectAll(".brush").remove(),t._addBrush()}),"keyup")},T.prototype._createZoomFn=function(){return function(){var t=this,e=b.b.transform,s=this.zoomCoordinates[1]-this.zoomCoordinates[0],a=(s-s/e.k)/2,n=[Math.max(this.zoomCoordinates[0]+a,this.scales.xNav(0)),Math.min(this.zoomCoordinates[1]-a,this.scales.xNav.domain()[1])];n[1]-n[0]<500&&e.k>1||(this.zoomCoordinates=n,e.rescaleX(this.scales.xMain),this.axes.xMain=this.axes.xMain.scale(this.scales.xMain),this.svg.select(".xMain.axis").call(this.axes.xMain),this._drawBars(),this._drawZoomGenes(this.annotations),this.navGraph.select(".brush").call(this.brush.move,(function(){return t.zoomCoordinates.map(t.scales.xNav)})))}},T.prototype._drawMainNavElements=function(){this.mainGraph=this.svg.append("g").attr("class","main").attr("transform","translate("+this.offsets.x1+","+this.offsets.y1Main+")"),this.navGraph=this.svg.append("g").attr("class","nav").attr("transform","translate("+this.offsets.x1+","+this.offsets.y1Nav+")"),this.geneGraph=this.svg.append("g").attr("class","Gene").attr("transform","translate("+this.offsets.x1+","+this.offsets.y1Gene+")")},T.prototype._addClipMask=function(){this.svg.append("g").append("clipPath").attr("class","clipPath").attr("transform","translate("+this.offsets.x1+","+this.offsets.y1Main+")").attr("id","clip").append("rect").attr("id","cliprect").attr("width",this.offsets.width).attr("height",this.offsets.heightMain)};var A,L,P,Y=T,Z=function(t){var e=t.hovered,s=t.width,a=t.height,n=t.mutType,o=t.showCounts,i=t.geneMap;if(!e)return null;var r={container:{position:"absolute",width:200,padding:"10px",borderRadius:10,zIndex:1e3,pointerEvents:"none",fontFamily:N.e.panel.fontFamily,fontSize:14,lineHeight:1,fontWeight:N.e.panel.fontWeight,color:N.e.panel.color,backgroundColor:N.e.panel.backgroundColor,wordWrap:"break-word",wordBreak:"break-word"}},l=document.getElementById("entropyYAxis").getBoundingClientRect(),c={x:e.x-l.left+15,y:e.y-l.top};c.x<.7*s?r.container.left=c.x:r.container.right=s-c.x,c.y<.5*a?r.container.top=c.y:r.container.bottom=a-c.y;var h=e.d.prot?"-"===i[e.d.prot].strand:null,d=e.d.prot?"aa"===n?h?i[e.d.prot].end-3*e.d.codon+3:i[e.d.prot].start+3*e.d.codon:h?i[e.d.prot].end-e.d.x:e.d.x-i[e.d.prot].start-1:null,p=e.d.prot&&"aa"!==n?Math.floor(d/3)+1:null;return v.a.createElement("div",{style:r.container},v.a.createElement("div",{className:"tooltip",style:N.e.tooltip},v.a.createElement("div",null,"aa"===n?"Codon ".concat(e.d.codon," in protein ").concat(e.d.prot):e.d.prot?"Nucleotide ".concat(e.d.x," (codon ").concat(p," in protein ").concat(e.d.prot,")"):"Nucleotide ".concat(e.d.x)),v.a.createElement("p",null),v.a.createElement("div",null,"aa"===n?"Nuc positions ".concat(d-2," to ").concat(d):""),v.a.createElement("p",null),v.a.createElement("div",null,null===h?"":h?"Negative strand":"Positive strand"),v.a.createElement("p",null),v.a.createElement("div",null,o?"Num mutations: ".concat(e.d.y):"entropy: ".concat(e.d.y)),v.a.createElement("div",{style:N.e.comment},"Click to color tree & map")))},D=s(98);s(120),s(530);function H(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function R(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?H(s,!0).forEach((function(e){f()(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):H(s).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var F=Object(g.b)((function(t){return{mutType:t.controls.mutType,bars:t.entropy.bars,annotations:t.entropy.annotations,geneMap:t.entropy.geneMap,geneLength:t.controls.geneLength,maxYVal:t.entropy.maxYVal,showCounts:t.entropy.showCounts,loaded:t.entropy.loaded,colorBy:t.controls.colorBy,zoomMin:t.controls.zoomMin,zoomMax:t.controls.zoomMax,defaultColorBy:t.controls.defaults.colorBy,shouldReRender:!1,panelLayout:t.controls.panelLayout,narrativeMode:t.narrative.display}}))((P=L=function(t){function e(t){var s;return n()(this,e),(s=l()(this,h()(e).call(this,t))).state={hovered:!1,chart:!1},s}return p()(e,t),i()(e,[{key:"onHover",value:function(t,e,s){this.setState({hovered:{d:t,type:".tip",x:e,y:s}})}},{key:"onLeave",value:function(){this.setState({hovered:!1})}},{key:"onClick",value:function(t){if(!this.props.narrativeMode){var e=function(t,e){return Object(G.encodeColorByGenotype)("aa"===t?{gene:e.prot,positions:[e.codon]}:{positions:[e.x]})}(this.props.mutType,t);Object(D.analyticsControlsEvent)("color-by-genotype"),this.props.dispatch(Object(w.a)(e)),this.setState({hovered:!1})}}},{key:"changeMutTypeCallback",value:function(t){t!==this.props.mutType&&(this.props.dispatch(Object(w.a)(this.props.defaultColorBy)),this.props.dispatch(Object(E.a)(t)))}},{key:"aaNtSwitch",value:function(t){var e=this;return this.props.narrativeMode?null:v.a.createElement("div",{style:R({},N.l,{},t.aaNtSwitch)},v.a.createElement("button",{key:1,style:"aa"===this.props.mutType?N.n:N.m,onClick:function(){return e.changeMutTypeCallback("aa")}},v.a.createElement("span",{style:t.switchTitle}," ","AA"," ")),v.a.createElement("button",{key:2,style:"aa"!==this.props.mutType?N.n:N.m,onClick:function(){return e.changeMutTypeCallback("nuc")}},v.a.createElement("span",{style:t.switchTitle}," ","NT"," ")))}},{key:"entropyCountSwitch",value:function(t){var e=this;return this.props.narrativeMode?null:v.a.createElement("div",{style:R({},N.l,{},t.entropyCountSwitch)},v.a.createElement("button",{key:1,style:this.props.showCounts?N.m:N.n,onClick:function(){return e.props.dispatch(Object(E.c)(!1))}},v.a.createElement("span",{style:t.switchTitle}," ","entropy"," ")),v.a.createElement("button",{key:2,style:this.props.showCounts?N.n:N.m,onClick:function(){return e.props.dispatch(Object(E.c)(!0))}},v.a.createElement("span",{style:t.switchTitle}," ","events"," ")))}},{key:"setUp",value:function(t){var e=new Y(this.d3entropy,t.annotations,t.geneMap,t.geneLength[S.nucleotide_gene],{onHover:this.onHover.bind(this),onLeave:this.onLeave.bind(this),onClick:this.onClick.bind(this)});e.render(t),t.narrativeMode&&Object(b.f)(this.d3entropy).selectAll(".handle--custom").style("visibility","hidden"),this.setState({chart:e})}},{key:"componentDidMount",value:function(){this.props.loaded&&this.setUp(this.props)}},{key:"componentWillReceiveProps",value:function(t){if(t.loaded||this.setState({chart:!1}),this.state.chart){if(this.props.width!==t.width||this.props.height!==t.height)this.state.chart.render(t);else{var e={};if(this.props.zoomMax===t.zoomMax&&this.props.zoomMin===t.zoomMin||(e.zoomMax=t.zoomMax,e.zoomMin=t.zoomMin),this.props.bars!==t.bars&&(e.aa="aa"===t.mutType,e.newBars=t.bars,e.maxYVal=t.maxYVal),this.props.colorBy!==t.colorBy&&(Object(G.isColorByGenotype)(this.props.colorBy)||Object(G.isColorByGenotype)(t.colorBy)))if(Object(G.isColorByGenotype)(t.colorBy)){var s=Object(G.decodeColorByGenotype)(t.colorBy,t.geneLength);if(s.aa)e.gene=s.gene,e.start=t.geneMap[e.gene].start,e.end=t.geneMap[e.gene].end;else{var a,n,o=s.positions,i=this.state.chart.zoomCoordinates,r=this.state.chart.maxNt;if(o.length>1){var l=Math.min.apply(null,o),c=Math.max.apply(null,o);a=l-.05*(c-l),n=c+.05*(c-l)}else{var h=o[0],d=.05*r,p=h-d<=0?[0,h+d]:h+d>=r?[h-d,r]:[h-d,h+d];a=p[0],n=p[1]}a>i[0]-.4*r&&a<i[0]+.4*r&&n>i[1]-.4*r&&n<i[1]+.4*r&&o.every((function(t){return t>i[0]}))&&o.every((function(t){return t<i[1]}))||(e.gene=s.gene,e.start=a,e.end=n)}e.selected=Object(G.decodeColorByGenotype)(t.colorBy,t.geneLength)}else e.clearSelected=!0;Object.keys(e).length&&this.state.chart.update(e)}this.props.narrativeMode!==t.narrativeMode&&(t.narrativeMode?Object(b.f)(this.d3entropy).selectAll(".handle--custom").style("visibility","hidden"):Object(b.f)(this.d3entropy).selectAll(".handle--custom").style("visibility","visible"))}else t.loaded&&this.setUp(t)}},{key:"render",value:function(){var t,e=this,s={switchContainer:{position:"absolute",marginTop:-5,paddingLeft:(t=this.props.width)-100},switchContainerWide:{position:"absolute",marginTop:-25,paddingLeft:t-185},switchTitle:{margin:5,position:"relative",top:-1},aaNtSwitch:{position:"absolute",right:5,top:0,zIndex:100},entropyCountSwitch:{position:"absolute",right:74,top:0,zIndex:100}};return v.a.createElement(M.a,{title:"Diversity"},v.a.createElement(Z,{hovered:this.state.hovered,width:this.props.width,height:this.props.height,mutType:this.props.mutType,showCounts:this.props.showCounts,geneMap:this.props.geneMap}),v.a.createElement("svg",{id:"d3entropyParent",style:{pointerEvents:"auto"},width:this.props.width,height:this.props.height},v.a.createElement("g",{ref:function(t){e.d3entropy=t},id:"d3entropy"})),this.aaNtSwitch(s),this.entropyCountSwitch(s))}}]),e}(v.a.Component),f()(L,"propTypes",{dispatch:x.a.func.isRequired,entropy:x.a.object,loaded:x.a.bool.isRequired,colorBy:x.a.string,defaultColorBy:x.a.string,mutType:x.a.string.isRequired}),A=P))||A;e.default=F}}]);
//# sourceMappingURL=auspice.chunk.8.bundle.js.map